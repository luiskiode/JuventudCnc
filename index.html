<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="color-scheme" content="dark light" />
  <meta name="description" content="Juventud CNC â€” Un espacio para crecer, servir y caminar juntos." />
  <title>Juventud CNC</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0b1020" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />

  <!-- Build -->
  <script>
    window.JC_BUILD = "2026-01-08.01"; // cambia esto en cada release
  </script>

  <!-- Styles (solo una vez, versionado) -->
  <link rel="stylesheet" href="styles.css?v=2026-01-08.01" />

  <!-- Supabase SDK (SIN defer) -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <!-- Config (SIN defer) - si define flags/constantes globales -->
  <script src="js/config.js?v=2026-01-08.01"></script>

  <!-- Supabase client (SIN defer, despuÃ©s del SDK y config) -->
  <script src="supabase-config.js?v=2026-01-08.01"></script>

  <!-- App modules (DEFER) -->
  <script defer src="js/ui.js?v=2026-01-08.01"></script>
  <script defer src="js/auth.js?v=2026-01-08.01"></script>
  <script defer src="js/bots.js?v=2026-01-08.01"></script>
  <script defer src="js/events.js?v=2026-01-08.01"></script>
  <script defer src="js/profile.js?v=2026-01-08.01"></script>
  <script defer src="js/community.js?v=2026-01-08.01"></script>
  <script defer src="js/resources.js?v=2026-01-08.01"></script>
  <script defer src="js/main.js?v=2026-01-08.01"></script>
</head>


<body class="app-shell">

  <!-- Fondo global (siempre detrÃ¡s de toda la app) -->
  <div id="jcAppBgLayer"></div>
  <div id="jcAppBgOverlay"></div>

  <noscript>
    <div style="padding:12px; margin:12px; border-radius:12px; background:#111827; color:#fff;">
      âš ï¸ Esta app necesita JavaScript para funcionar.
    </div>
  </noscript>

  <!-- OVERLAY GLOBAL -->
  <div id="overlay" class="overlay" aria-hidden="true"></div>

  <!-- DRAWER -->
  <aside id="drawer" class="drawer" aria-label="MenÃº lateral">
    <div class="drawer-header">
      <h2>Juventud CNC</h2>
      <button id="closeDrawer" class="icon-btn" type="button" aria-label="Cerrar menÃº">âœ•</button>
    </div>

    <nav class="drawer-nav" aria-label="Secciones">
      <!-- ACCIONES -->
      <button type="button" data-tab="cursos" class="drawer-link">ğŸ“ Mis cursos</button>
      <button type="button" id="btnPause30" class="drawer-link">â±ï¸ Pausa 30 segundos</button>
      <button type="button" data-tab="box" class="drawer-link">ğŸ“¦ Box</button>
      <button type="button" data-tab="miembros-activos" class="drawer-link">â­ Miembros</button>
      <button type="button" data-tab="notificaciones" class="drawer-link">ğŸ”” Notificaciones</button>

      <hr />

      <!-- PERFIL -->
      <button type="button" data-tab="perfil" class="drawer-link">ğŸ‘¤ Mi perfil</button>
    </nav>

    <footer class="drawer-footer">
      v1.0 Â· Juventud CNC ğŸ’™ğŸ’—
    </footer>
  </aside>

<!-- TOPBAR -->
<header class="topbar" role="banner">
  <div class="topbar-inner">
    <button id="openDrawer" class="icon-btn" type="button" aria-label="Abrir menÃº">â˜°</button>

    <h1 class="topbar-title">Juventud CNC</h1>

    <div class="topbar-actions" aria-label="Acciones">
      <select id="themePicker" class="theme-picker" aria-label="Tema">
        <option value="auto">Auto</option>
        <option value="chicos">Chicos ğŸ’™</option>
        <option value="chicas">Chicas ğŸ’—</option>
        <option value="mix">Mix ğŸ’™ğŸ’—</option>
      </select>

      <button id="btnBots" class="icon-btn" type="button" title="Encender / Apagar bots" aria-label="Encender o apagar bots">ğŸ¤–</button>
      <button id="btnAngie" class="icon-btn" type="button" title="DiseÃ±o Angie" aria-label="DiseÃ±o Angie">ğŸ¨</button>
      <button id="btnLogin" class="icon-btn" type="button" title="Iniciar sesiÃ³n" aria-label="Iniciar sesiÃ³n">ğŸ”‘</button>
      <button id="btnPerfil" class="icon-btn" type="button" data-tab="perfil" title="Mi perfil" aria-label="Mi perfil">ğŸ‘¤</button>
    </div>
  </div>
</header>

  <!-- CONTENIDO -->
  <main class="container" id="main">

    <!-- INICIO -->
    <section class="view active" data-view="inicio" aria-label="Inicio">
      <section class="card" id="mensaje-semanal">
        <header class="card-header">
          <h2 class="with-emoji" data-emoji="ğŸ•Šï¸">Mensaje semanal</h2>
          <span class="badge badge-mix">Para todos</span>
        </header>

        <article class="card-body">
          <h3 id="msgTitle">Cargando mensaje...</h3>
          <p id="msgBody">Un momentoâ€¦</p>
          <small id="msgMeta"></small>
        </article>
      </section>

      <section class="card hero" aria-label="Bienvenida">
        <div>
          <h2>Bienvenido a Juventud CNC</h2>
          <p>Un espacio para crecer, servir y caminar juntos.</p>
          <p class="small" style="margin-top:8px; opacity:.95">
            Consejo rÃ¡pido: usa <strong>ğŸ¤–</strong> para encender/apagar bots, y <strong>ğŸ¨</strong> para el diseÃ±o de Angie.
          </p>
        </div>
      </section>

      <section class="card" aria-label="Eventos prÃ³ximos">
        <div class="card-header">
          <h3 class="with-emoji" data-emoji="ğŸ“…">PrÃ³ximos eventos</h3>
          <button type="button" data-tab="eventos" class="link" aria-label="Ver todos los eventos">Ver todos</button>
        </div>
        <ul id="eventListHome" class="event-list"></ul>
      </section>
    </section>

    <!-- BOX -->
    <section class="view" data-view="box" aria-label="Box">
      <div class="jc-card-mini">
        <h4>ğŸ–¼ï¸ Fondo global</h4>
        <p class="muted small">Elige una imagen de tu galerÃ­a. Se aplica al fondo principal.</p>

        <div class="jc-row" style="gap:.5rem; flex-wrap:wrap;">
          <button id="btnBgPick" type="button">Elegir fondo</button>
          <button id="btnBgClear" type="button">Quitar fondo</button>
          <input id="bgPickerInput" type="file" accept="image/*" hidden />
          <small id="bgPickEstado" aria-live="polite"></small>
        </div>
      </div>

      <section class="card">
        <header class="card-header">
          <div>
            <h2 class="with-emoji" data-emoji="ğŸ“¦">Box</h2>
            <p class="muted small" style="margin:4px 0 0">
              AquÃ­ vive el chat grande de los bots (sin tapar nada).
            </p>
          </div>
        </header>

        <div id="boxChatMount" class="box-chat-mount"></div>
        
         <!-- Chat bots (mini) -->
  <section id="jcChat" class="jc-chat" aria-label="Chat de bots" style="display:none">
    <header class="jc-chat-header">
      <div class="jc-chat-title">
        <span class="dot-online" aria-hidden="true"></span>
        <span>Chat bots</span>
      </div>
      <button class="jc-chat-toggle" id="jcChatToggle" type="button" aria-label="Colapsar chat">âŒ„</button>
    </header>
    <div class="jc-chat-body" id="jcChatBody"></div>
  </section>

      </section>
    </section>

    <!-- EVENTOS -->
    <section class="view" data-view="eventos" aria-label="Eventos">
      <section class="card">
        <header class="card-header">
          <div>
            <h2 class="with-emoji" data-emoji="ğŸ“…">Eventos</h2>
            <p class="muted small" style="margin:4px 0 0">Calendario + lista. Solo miembros gestionan.</p>
          </div>

          <div class="event-toolbar" aria-label="Herramientas de eventos">
            <select id="filtroTipo" aria-label="Filtrar por tipo">
              <option value="">Todos</option>
              <option value="formacion">FormaciÃ³n</option>
              <option value="servicio">Servicio</option>
              <option value="convivencia">Convivencia</option>
              <option value="oracion">OraciÃ³n</option>
            </select>

            <select id="evScope" aria-label="Rango">
              <option value="upcoming">PrÃ³ximos</option>
              <option value="all">Todos</option>
              <option value="past">Pasados</option>
            </select>

            <button id="btnEvRefresh" class="btn small ghost" type="button">Actualizar</button>
          </div>
        </header>

        <div id="evGate" class="muted small" style="margin-top:10px">Cargando estadoâ€¦</div>

        <section class="event-cal" aria-label="Calendario" style="margin-top:12px">
          <div class="event-cal-head">
            <button id="evCalPrev" class="icon-mini" type="button" aria-label="Mes anterior">â€¹</button>
            <div id="evCalLabel" class="event-cal-label">Mes</div>
            <button id="evCalNext" class="icon-mini" type="button" aria-label="Mes siguiente">â€º</button>
          </div>

          <div class="event-cal-weekdays" aria-hidden="true">
            <span>L</span><span>M</span><span>X</span><span>J</span><span>V</span><span>S</span><span>D</span>
          </div>

          <div id="evCalendar" class="event-cal-grid"></div>

          <div class="event-cal-foot">
            <span id="evDayHint" class="muted small">Toca un dÃ­a para filtrar</span>
            <button id="evClearDay" class="btn small ghost" type="button" style="display:none">Ver todos</button>
          </div>
        </section>

        <div class="event-search-row">
          <input id="evSearch" class="event-search" type="search" placeholder="Buscar por tÃ­tulo o lugarâ€¦" />
          <select id="evSort" aria-label="Orden">
            <option value="asc">MÃ¡s cercanos</option>
            <option value="desc">MÃ¡s recientes</option>
          </select>
        </div>

        <details id="evCreateWrap" class="event-create" open style="margin-top:12px; display:none">
          <summary class="event-create-summary">
            <strong>Crear evento</strong>
            <span class="muted small">Toca para abrir/cerrar</span>
          </summary>

          <form id="formEvento" class="grid perfil-form" aria-label="Crear evento" style="margin-top:10px">
            <input id="evTitulo" placeholder="TÃ­tulo" required />
            <input id="evFecha" type="datetime-local" required />
            <input id="evLugar" placeholder="Lugar" />
            <select id="evTipo" aria-label="Tipo">
              <option value="">Tipo</option>
              <option value="formacion">FormaciÃ³n</option>
              <option value="servicio">Servicio</option>
              <option value="convivencia">Convivencia</option>
              <option value="oracion">OraciÃ³n</option>
            </select>

            <button class="btn small" type="submit">Guardar</button>
            <p id="evEstado" class="small muted"></p>
          </form>
        </details>

        <ul id="eventList" class="event-list"></ul>
      </section>
    </section>

    <!-- MODAL EDITAR EVENTO -->
    <div id="evModal" class="jc-modal" style="display:none">
      <div class="jc-modal-card" role="dialog" aria-modal="true" aria-label="Editar evento">
        <header class="jc-modal-header">
          <div>
            <h3>âœï¸ Editar evento</h3>
            <p class="muted small" id="evModalMeta">â€”</p>
          </div>
          <button id="evModalClose" class="icon-btn" type="button">âœ•</button>
        </header>

        <div class="jc-modal-body">
          <form id="evEditForm" class="grid perfil-form" aria-label="Formulario editar evento">
            <input id="evEditTitulo" placeholder="TÃ­tulo" required />
            <input id="evEditFecha" type="datetime-local" required />
            <input id="evEditLugar" placeholder="Lugar" />
            <select id="evEditTipo" aria-label="Tipo">
              <option value="">Tipo</option>
              <option value="formacion">FormaciÃ³n</option>
              <option value="servicio">Servicio</option>
              <option value="convivencia">Convivencia</option>
              <option value="oracion">OraciÃ³n</option>
            </select>

            <div style="display:flex; gap:10px; flex-wrap:wrap">
              <button class="btn" type="submit">Guardar cambios</button>
              <button id="evEditDelete" class="btn ghost" type="button">ğŸ—‘ï¸ Borrar</button>
            </div>

            <p id="evEditEstado" class="small muted" style="margin:0"></p>
          </form>
        </div>
      </div>
    </div>

    <!-- COMUNIDAD -->
    <section class="view" data-view="comunidad" aria-label="Comunidad">
      <section class="card">
        <header class="card-header">
          <div>
            <h2 class="with-emoji" data-emoji="ğŸ‘¥">Comunidad</h2>
            <p class="muted small">Retos + dinÃ¡micas + foro. Solo miembros registrados publican, comentan y reaccionan â¤ï¸</p>
          </div>
          <span id="comuLockBadge" class="badge badge-mix">ğŸ”’ Solo miembros</span>
        </header>

        <div class="comu-tabs" role="tablist" aria-label="CategorÃ­as de comunidad">
          <button class="comu-tab active" type="button" data-comu-cat="chicos" role="tab" aria-selected="true">ğŸ’™ Retos chicos</button>
          <button class="comu-tab" type="button" data-comu-cat="chicas" role="tab" aria-selected="false">ğŸ’— Retos chicas</button>
          <button class="comu-tab" type="button" data-comu-cat="dinamicas" role="tab" aria-selected="false">ğŸ”„ DinÃ¡micas</button>
          <button class="comu-tab" type="button" data-comu-cat="foro" role="tab" aria-selected="false">ğŸ’¬ Foro</button>
        </div>

        <div id="comuGate" class="comu-gate muted small" style="margin-top:10px">Cargando estadoâ€¦</div>

        <div id="comuComposer" class="comu-composer" style="margin-top:12px; display:none">
          <div class="comu-composer-head">
            <strong>Publicar</strong>
            <span class="muted small">Comparte una idea, reto o dinÃ¡mica</span>
          </div>

          <form id="formComuPost" class="grid comu-form" aria-label="Crear publicaciÃ³n comunidad">
            <input id="comuTitulo" maxlength="120" placeholder="TÃ­tulo (ej: Reto de la semana)" required />
            <textarea id="comuContenido" rows="3" maxlength="4000" placeholder="Escribe tu publicaciÃ³nâ€¦" required></textarea>

            <div class="comu-actions">
              <button class="btn" type="submit">Publicar</button>
              <button id="btnComuClear" class="btn ghost" type="button">Limpiar</button>
            </div>

            <p id="comuEstado" class="small muted" style="margin:0" aria-live="polite"></p>
          </form>
        </div>

        <div class="comu-feed" style="margin-top:14px">
          <div class="comu-feed-head">
            <h3 class="with-emoji" data-emoji="ğŸ“°">Publicaciones</h3>
            <button id="btnComuRefresh" class="btn small ghost" type="button">Actualizar</button>
          </div>

          <div id="comuList" class="comu-list">
            <div class="muted small">Cargando publicacionesâ€¦</div>
          </div>
        </div>
      </section>

      <div id="comuModal" class="jc-modal" style="display:none">
        <div class="jc-modal-card" role="dialog" aria-modal="true" aria-label="Comentarios comunidad">
          <header class="jc-modal-header">
            <div>
              <h3 id="comuModalTitle">Comentarios</h3>
              <p id="comuModalMeta" class="muted small">â€”</p>
            </div>
            <button id="comuModalClose" class="icon-btn" type="button">âœ•</button>
          </header>

          <div class="jc-modal-body">
            <div id="comuCommentsList" class="comu-comments"></div>

            <div id="comuCommentComposer" class="comu-composer" style="margin-top:12px; display:none">
              <form id="formComuComment" class="grid comu-form" aria-label="Agregar comentario">
                <textarea id="comuCommentText" rows="2" maxlength="1500" placeholder="Escribe un comentarioâ€¦" required></textarea>
                <div class="comu-actions">
                  <button class="btn" type="submit">Comentar</button>
                  <button id="btnComuCommentClear" class="btn ghost" type="button">Limpiar</button>
                </div>
                <p id="comuCommentEstado" class="small muted" style="margin:0" aria-live="polite"></p>
              </form>
            </div>

            <div id="comuCommentGate" class="muted small" style="margin-top:10px">
              ğŸ”’ RegÃ­strate para comentar.
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- RECURSOS (CATEFA) -->
    <section class="view" data-view="recursos" aria-label="Recursos">
      <div class="view-head">
        <h2>ğŸ“š Recursos (Catefa)</h2>
        <p class="muted small">
          AquÃ­ vive Catefa: asistencias, seguimiento de temas y enlaces Ãºtiles. Todo con blindaje RLS ğŸ”’
        </p>
      </div>

      <div class="jc-card-mini" style="margin-top:.75rem;">
        <div id="catefaGate" class="muted small">Cargando Catefaâ€¦</div>

        <div class="jc-row" style="margin-top:.75rem; gap:.5rem; flex-wrap:wrap;">
          <button class="btn small" type="button" id="btnCatefaRefresh">ğŸ”„ Actualizar</button>

          <button class="btn small" type="button" id="btnVaticano">ğŸŒ Vaticano</button>
          <button class="btn small" type="button" id="btnBiblia">ğŸ“– Biblia Online</button>

          <a id="linkVaticano"
             href="https://www.vatican.va/content/vatican/es.html"
             target="_blank" rel="noopener noreferrer"
             class="link"
             style="display:none">Abrir Vaticano</a>

          <a id="linkBiblia"
             href="https://es.jesus.net/biblia/salmo-23"
             target="_blank" rel="noopener noreferrer"
             class="link"
             style="display:none">Abrir Biblia</a>

          <span id="catefaEstado" class="muted small" style="margin-left:auto;" aria-live="polite"></span>
        </div>
      </div>

      <div class="jc-card-mini" style="margin-top:.75rem;">
        <h4>Enlaces Ãºtiles</h4>
        <div class="muted small">
          - Vaticano: noticias, documentos y guÃ­a espiritual.<br />
          - Biblia Online: lectura rÃ¡pida y bÃºsqueda por versÃ­culos.
        </div>
      </div>

      <div class="jc-card-mini" style="margin-top:.75rem;">
        <h4>Mi grupo de Catequesis</h4>
        <div class="grid" style="margin-top:.5rem;">
          <label>
            Grupo
            <select id="catefaGrupoSelect">
              <option value="">(Cargandoâ€¦)</option>
            </select>
          </label>
        </div>
        <div class="muted small" style="margin-top:.5rem;">
          Si no ves grupos, es porque RLS no te asignÃ³ ninguno (o aÃºn no existe tu asignaciÃ³n).
        </div>
      </div>

      <div class="jc-card-mini" style="margin-top:.75rem;">
        <h4>â• Nueva sesiÃ³n (tema)</h4>
        <div class="grid" style="margin-top:.5rem;">
          <label>
            Tema
            <input id="catefaTema" type="text" placeholder="Ej: La oraciÃ³n, Los sacramentos..." />
          </label>
          <label>
            Fecha y hora
            <input id="catefaFecha" type="datetime-local" />
          </label>
        </div>
        <div class="jc-row" style="margin-top:.5rem;">
          <button class="btn" type="button" id="btnCatefaNuevaSesion">Guardar sesiÃ³n</button>
        </div>
      </div>

      <div class="jc-card-mini" style="margin-top:.75rem;">
        <h4>â• Registrar niÃ±o</h4>
        <div class="grid" style="margin-top:.5rem;">
          <label>
            Nombre
            <input id="catefaNinoNombre" type="text" placeholder="Nombre del niÃ±o" />
          </label>
          <label>
            Apellidos
            <input id="catefaNinoApellidos" type="text" placeholder="Apellidos (opcional)" />
          </label>
        </div>
        <div class="jc-row" style="margin-top:.5rem;">
          <button class="btn" type="button" id="btnCatefaNuevoNino">Agregar niÃ±o</button>
        </div>
      </div>

      <div class="jc-card-mini" style="margin-top:.75rem;">
        <h4>ğŸ‘¦ğŸ‘§ NiÃ±os del grupo</h4>
        <div id="catefaNinos">
          <div class="muted small">Selecciona un grupo para ver niÃ±os.</div>
        </div>
      </div>

      <div class="jc-card-mini" style="margin-top:.75rem;">
        <h4>ğŸ—“ï¸ Sesiones / Temas</h4>
        <div id="catefaSesiones">
          <div class="muted small">Selecciona un grupo para ver sesiones.</div>
        </div>
      </div>

      <div id="catefaAsistenciaPanel" style="margin-top:.75rem;"></div>

      <div class="jc-card-mini" style="margin-top:.75rem;">
        <h4>ğŸ”’ Blindaje (RLS)</h4>
        <p class="muted small">
          Supabase bloquea todo por polÃ­ticas RLS. Solo animadores autorizados ven/registran asistencias.
        </p>
      </div>
    </section>

    <!-- JUDART -->
    <section class="view" data-view="judart" aria-label="Judart">
      <section class="card">
        <header class="card-header">
          <div>
            <h2 class="with-emoji" data-emoji="ğŸ¨">Judart</h2>
            <p class="muted small" style="margin:4px 0 0">
              Taller creativo: galerÃ­a + retos. Solo miembros suben y reaccionan â¤ï¸
            </p>
          </div>
          <span id="judGateBadge" class="badge badge-mix">ğŸ”’ Solo miembros</span>
        </header>

        <div id="judGate" class="muted small" style="margin-top:10px">Cargando estadoâ€¦</div>

        <div class="comu-tabs" role="tablist" aria-label="Judart tabs" style="margin-top:12px">
          <button class="comu-tab active" type="button" data-jud-tab="galeria" aria-selected="true">ğŸ–¼ï¸ GalerÃ­a</button>
          <button class="comu-tab" type="button" data-jud-tab="subir" aria-selected="false">â¬†ï¸ Subir arte</button>
          <button class="comu-tab" type="button" data-jud-tab="retos" aria-selected="false">ğŸ”¥ Retos</button>
        </div>

        <div id="judPanelGaleria" style="margin-top:12px">
          <div class="jc-row" style="justify-content:space-between; flex-wrap:wrap; gap:10px">
            <input id="judSearch" type="search" placeholder="Buscar por tÃ­tulo/autorâ€¦" style="flex:1; min-width:220px" />
            <button id="judRefresh" class="btn small ghost" type="button">Actualizar</button>
          </div>

          <div id="judList" class="catefa-list" style="margin-top:12px">
            <div class="muted small">Cargando galerÃ­aâ€¦</div>
          </div>
        </div>

        <div id="judPanelSubir" style="margin-top:12px; display:none">
          <div class="jc-card-mini">
            <h4>â¬†ï¸ Publicar en Judart</h4>
            <p class="muted small">Sube una imagen (recomendado) o pega un link (Drive, YouTube, etc.).</p>

            <form id="judForm" class="grid perfil-form" style="margin-top:10px">
              <input id="judTitulo" placeholder="TÃ­tulo (ej: Mi dibujo de Adviento)" maxlength="120" required />
              <textarea id="judDesc" rows="3" placeholder="DescripciÃ³n / mensaje" maxlength="1500"></textarea>

              <select id="judMediaType" aria-label="Tipo">
                <option value="image">Imagen (subir)</option>
                <option value="link">Link (URL)</option>
              </select>

              <input id="judUrl" placeholder="https://..." style="display:none" />
              <input id="judFile" type="file" accept="image/*" />

              <div style="display:flex; gap:10px; flex-wrap:wrap">
                <button class="btn" type="submit">Publicar</button>
                <button id="judClear" class="btn ghost" type="button">Limpiar</button>
              </div>

              <p id="judEstado" class="small muted" style="margin:0" aria-live="polite"></p>
            </form>
          </div>
        </div>

        <div id="judPanelRetos" style="margin-top:12px; display:none">
          <div class="jc-card-mini">
            <h4>ğŸ”¥ Reto de la semana</h4>
            <p class="muted small" id="judRetoText">
              Dibuja una escena donde un niÃ±o aprende algo bueno (bondad/respeto) y escribe una frase motivadora.
            </p>
            <div class="jc-row" style="margin-top:10px; flex-wrap:wrap">
              <span class="catefa-badge">ğŸ’¡ Tip: usa colores simples y un mensaje corto.</span>
              <span class="catefa-badge">ğŸ•Šï¸ Meta: inspirar a los niÃ±os.</span>
            </div>
          </div>

          <div class="jc-card-mini" style="margin-top:10px">
            <h4>ğŸ“Œ Ideas rÃ¡pidas</h4>
            <ul class="muted small" style="margin:8px 0 0; padding-left:18px; line-height:1.4">
              <li>Una acciÃ³n buena que viste hoy.</li>
              <li>Una escena de catequesis (asistencia, tema, amistad).</li>
              <li>Un santo / una virtud (paciencia, humildad, servicio).</li>
            </ul>
          </div>
        </div>
      </section>

      <div id="judModal" class="jc-modal" style="display:none">
        <div class="jc-modal-card" role="dialog" aria-modal="true" aria-label="Judart preview">
          <header class="jc-modal-header">
            <div>
              <h3 id="judModalTitle">Arte</h3>
              <p id="judModalMeta" class="muted small">â€”</p>
            </div>
            <button id="judModalClose" class="icon-btn" type="button">âœ•</button>
          </header>
          <div class="jc-modal-body">
            <div id="judModalMedia" style="border-radius:14px; overflow:hidden"></div>
            <p id="judModalDesc" class="muted small" style="margin-top:10px"></p>
          </div>
        </div>
      </div>
    </section>

    <!-- CURSOS -->
    <section class="view" data-view="cursos" aria-label="Mis cursos">
      <section class="card">
        <header class="card-header">
          <div>
            <h2 class="with-emoji" data-emoji="ğŸ“">Mis cursos</h2>
            <p class="muted small">Invitaciones, talleres y material para jÃ³venes (HeForShe, Save for Home, etc.).</p>
          </div>
          <button id="btnCursosRefresh" class="btn small ghost" type="button">Actualizar</button>
        </header>

        <div id="cursosGate" class="muted small">Cargandoâ€¦</div>
        <div id="cursosList" class="grid" style="margin-top:12px"></div>
      </section>
    </section>

    <!-- NOTIFICACIONES -->
    <section class="view" data-view="notificaciones" aria-label="Notificaciones">
      <section class="card">
        <header class="card-header">
          <div>
            <h2 class="with-emoji" data-emoji="ğŸ””">Notificaciones</h2>
            <p class="muted small">Estado del permiso + registro de avisos del sistema.</p>
          </div>
        </header>

        <div class="jc-card-mini" style="margin-top:10px">
          <div class="jc-row" style="gap:.5rem; flex-wrap:wrap">
            <button id="btnNotiRequest" class="btn small" type="button">Activar notificaciones</button>
            <button id="btnNotiTest" class="btn small ghost" type="button">Probar</button>
            <span id="notiEstado" class="muted small" aria-live="polite"></span>
          </div>
        </div>

        <div class="jc-card-mini" style="margin-top:10px">
          <h4>ğŸ“Œ Registro</h4>
          <ul id="avisosList" class="notice-list"></ul>
          <p class="muted small" style="margin-top:8px">Tip: aquÃ­ tambiÃ©n caerÃ¡n logs de acciones (paleta, recursos, cursos, etc.).</p>
        </div>
      </section>
    </section>

    <!-- MIEMBROS -->
    <section class="view" data-view="miembros-activos" aria-label="Miembros">
      <section class="card">
        <header class="card-header">
          <div>
            <h2 class="with-emoji" data-emoji="â­">Miembros</h2>
            <p class="muted small" style="margin:4px 0 0">
              Lista de miembros registrados (segÃºn RLS). Si no ves nada, revisa sesiÃ³n o permisos.
            </p>
          </div>
          <button id="btnMiembrosRefresh" class="btn small ghost" type="button">Actualizar</button>
        </header>

        <div id="miembrosGate" class="muted small">Cargandoâ€¦</div>
        <div id="miembrosList" class="grid" style="margin-top:12px"></div>
      </section>
    </section>

    <!-- PERFIL -->
    <section class="view" data-view="perfil" aria-label="Mi perfil">
      <section class="card">
        <header class="card-header">
          <div>
            <h2 class="with-emoji" data-emoji="ğŸ‘¤">Mi perfil</h2>
            <p class="muted small" style="margin:4px 0 0">
              Tu informaciÃ³n personal y estado de sesiÃ³n.
            </p>
          </div>
          <button id="btnPerfilRefresh" class="btn small ghost" type="button">Actualizar</button>
        </header>

        <div id="perfilGate" class="muted small">Cargandoâ€¦</div>

        <div id="perfilBox" class="jc-card-mini" style="margin-top:12px; display:none">
          <div class="jc-row" style="justify-content:space-between; flex-wrap:wrap; gap:10px">
            <div>
              <strong id="perfilNombre">â€”</strong><br />
              <small id="perfilEmail" class="muted">â€”</small>
            </div>
            <div style="display:flex; gap:10px; flex-wrap:wrap">
              <button id="btnLogout" class="btn small ghost" type="button">Cerrar sesiÃ³n</button>
            </div>
          </div>

          <hr style="margin:12px 0; opacity:.2" />

          <form id="perfilForm" class="grid perfil-form" aria-label="Editar perfil">
            <input id="perfilNombreInput" placeholder="Tu nombre" />
            <input id="perfilRolInput" placeholder="Rol (ej: miembro, animador)" />
            <button class="btn small" type="submit">Guardar</button>
            <p id="perfilEstado" class="small muted" style="margin:0" aria-live="polite"></p>
          </form>
        </div>

        <div id="perfilHint" class="jc-card-mini" style="margin-top:12px">
          <p class="muted small" style="margin:0">
            ğŸ”‘ Si no estÃ¡s logueado, usa el botÃ³n de arriba â€œIniciar sesiÃ³nâ€.
          </p>
        </div>
      </section>
    </section>

  </main>

  <!-- NAV INFERIOR -->
  <nav class="tabs" aria-label="NavegaciÃ³n inferior">
    <button class="tab active" type="button" data-tab="inicio">ğŸ <span>Inicio</span></button>
    <button class="tab" type="button" data-tab="eventos">ğŸ“…<span>Eventos</span></button>
    <button class="tab" type="button" data-tab="comunidad">ğŸ‘¥<span>Comunidad</span></button>
    <button class="tab" type="button" data-tab="recursos">ğŸ“‚<span>Recursos</span></button>
    <button class="tab" type="button" data-tab="judart">ğŸ¨<span>Judart</span></button>
  </nav>

  <!-- Angie -->
  <div id="angieWidget" class="angie-widget" aria-label="Angie">
    <div class="bot-bubble angie-bubble">
      <button id="angieClose" class="bot-close" type="button" aria-label="Cerrar Angie">âœ•</button>
      <div class="bot-name angie-name">Angie</div>
      <div id="angieText">Â¡Holaaa! QuÃ© bueno verte ğŸ˜„</div>
    </div>
    <div class="bot-avatar angie-avatar">
      <img id="angieAvatarImg" src="assets/angie-feliz-saludo.png" alt="Angie" loading="lazy" />
    </div>
  </div>

  <!-- Mia -->
  <div id="miaWidget" class="mia-widget" aria-label="Mia">
    <div class="bot-bubble mia-bubble">
      <button id="miaClose" class="bot-close" type="button" aria-label="Cerrar Mia">âœ•</button>
      <div class="bot-name mia-name">Mia</div>
      <div id="miaText">Soy Mia. AquÃ­ todo lo coordinamos con calma ğŸ’—</div>
    </div>
    <div class="bot-avatar mia-avatar">
      <img id="miaAvatarImg" src="assets/mia-casual-wink.png" alt="Mia" loading="lazy" />
    </div>
  </div>

  <!-- Ciro -->
  <div id="ciroWidget" class="ciro-widget" aria-label="Ciro">
    <div class="bot-bubble ciro-bubble">
      <button id="ciroClose" class="bot-close" type="button" aria-label="Cerrar Ciro">âœ•</button>
      <div class="bot-name ciro-name">Ciro</div>
      <div id="ciroText">Â¡Holaaa! Â¡Vamos con fuerza! ğŸ’ªğŸ”¥</div>
    </div>
    <div class="bot-avatar ciro-avatar">
      <img id="ciroAvatarImg" src="assets/ciro-happy.png" alt="Ciro" loading="lazy" />
    </div>
  </div>

 

  <!-- Login Modal -->
  <div id="loginModal" class="jc-modal" style="display:none">
    <div class="jc-modal-card" role="dialog" aria-modal="true" aria-label="Iniciar sesiÃ³n">
      <header class="jc-modal-header">
        <div>
          <h3>ğŸ”‘ Iniciar sesiÃ³n</h3>
          <p class="muted small">Te enviamos un enlace a tu correo (Magic Link).</p>
        </div>
        <button id="loginClose" class="icon-btn" type="button">âœ•</button>
      </header>

      <div class="jc-modal-body">
        <form id="loginForm" class="grid perfil-form" aria-label="Formulario login">
          <input id="loginEmail" type="email" inputmode="email" autocomplete="email" placeholder="tu-correo@gmail.com" required />
          <button class="btn" type="submit">Enviar enlace</button>
          <p id="loginEstado" class="small muted" style="margin:0" aria-live="polite"></p>
        </form>

        <div class="muted small" style="margin-top:10px">
          ğŸ’¡ Tip: si ya estÃ¡s logueado, verÃ¡s tu perfil sin formulario.
        </div>
      </div>
    </div>
  </div>

  <!-- Pausa Modal -->
  <div id="pauseModal" class="jc-modal" style="display:none">
    <div class="jc-modal-card" role="dialog" aria-modal="true" aria-label="Pausa de 30 segundos">
      <header class="jc-modal-header">
        <div>
          <h3>â±ï¸ Pausa (30s)</h3>
          <p class="muted small" id="pauseHint">Respiraâ€¦ y vuelve con calma.</p>
        </div>
        <button id="pauseClose" class="icon-btn" type="button">âœ•</button>
      </header>

      <div class="jc-modal-body">
        <div class="pause-wrap">
          <div id="pauseTimer" class="pause-timer">30</div>
          <div id="pauseText" class="pause-text">Inhalaâ€¦ exhalaâ€¦</div>

          <div class="jc-row" style="gap:.5rem; flex-wrap:wrap; margin-top:12px">
            <button id="pauseStart" class="btn" type="button">Iniciar</button>
            <button id="pauseStop" class="btn ghost" type="button">Detener</button>
          </div>

          <div class="muted small" style="margin-top:10px">
            Sugerencia: â€œJesÃºs, confÃ­o en Tiâ€ / â€œSeÃ±or, aquÃ­ estoyâ€.
          </div>
        </div>
      </div>
    </div>
  </div>
<!-- Angie Palette Modal (iframe) -->
<div id="angiePaletteModal" class="jc-modal" style="display:none">
  <div class="jc-modal-card" role="dialog" aria-modal="true" aria-label="Paleta de Angie">
    <header class="jc-modal-header">
      <div>
        <h3>ğŸ¨ Paleta de Angie</h3>
        <p class="muted small">Cambia colores y se aplican en vivo.</p>
      </div>
      <button id="angiePaletteClose" class="icon-btn" type="button">âœ•</button>
    </header>

    <div class="jc-modal-body" style="padding:0">
      <iframe
        id="angiePaletteFrame"
        <iframe id="angiePaletteFrame" src="angie-herramienta.html" ...></iframe>
        title="Angie Â· Herramienta de colores"
        style="width:100%; height:min(78vh, 720px); border:0; border-radius:0 0 22px 22px; background:#fff;">
      </iframe>
    </div>
  </div>
</div>
</body>
</html>